(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-index-shine"],{"4e5d":function(t,a,e){"use strict";e("6a54"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i={baseURL:uni.getStorageSync("esp32_ip")||"http://192.168.4.1:5000"};a.default=i},"73e1":function(t,a,e){"use strict";var i=e("29d8");t.exports=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(i)},"795c":function(t,a,e){"use strict";var i=e("8bdb"),s=e("db04").start,n=e("73e1");i({target:"String",proto:!0,forced:n},{padStart:function(t){return s(this,t,arguments.length>1?arguments[1]:void 0)}})},"7ea9":function(t,a,e){"use strict";e("6a54");var i=e("3639").default,s=e("f5bd").default;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var n=s(e("2634")),c=s(e("b7c7")),r=s(e("2fdc"));e("c223"),e("f7a5"),e("fd3c"),e("795c"),e("c9b5"),e("bf0f"),e("ab80");var o=i(e("4500")),d=s(e("4e5d")),l={data:function(){return{currentLight:0,lightData:[],timeData:[],chart:null,timeFrame:"hour",dataUpdateInterval:null,chartUpdateInterval:null,systemStatus:"normal",chartOptions:{title:{text:"光照强度变化趋势",left:"center",textStyle:{fontSize:14,color:"#2c3e50"}},tooltip:{trigger:"item",formatter:function(t){return"".concat(t.name,"<br/>光照: ").concat(t.value," lux")},backgroundColor:"#ffffff",borderColor:"#4a90e2",borderWidth:1,textStyle:{color:"#333"}},grid:{left:"3%",right:"3%",bottom:"12%",top:"20%",containLabel:!0},xAxis:{type:"category",data:[],axisLabel:{fontSize:10,color:"#666"},axisLine:{lineStyle:{color:"#ddd"}},interval:2},yAxis:{type:"value",name:"光照强度 (lux)",nameTextStyle:{color:"#666",padding:[0,0,0,30]},axisLabel:{fontSize:10,color:"#666"},axisLine:{show:!0,lineStyle:{color:"#ddd"}},splitLine:{lineStyle:{color:"#f0f0f0"}},min:0,max:2e3,interval:500},series:[{type:"line",data:[],smooth:!0,lineStyle:{color:"#4a90e2",width:3},areaStyle:{color:new o.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"rgba(74, 144, 226, 0.3)"},{offset:1,color:"rgba(74, 144, 226, 0.1)"}])},symbol:"circle",symbolSize:6,itemStyle:{color:"#4a90e2",borderColor:"#fff",borderWidth:1}}]}}},computed:{lightStatus:function(){return this.currentLight>800?"high":this.currentLight<400?"low":"normal"},statusClass:function(){return this.lightStatus},statusMessage:function(){return{high:"光线过强",normal:"光照适中",low:"光线过弱"}[this.lightStatus]},statusIcon:function(){return{high:"☀️",normal:"🌤️",low:"🌙"}[this.lightStatus]},energySavingTip:function(){return this.currentLight>800&&"day"===this.timeOfDay?"检测到光线过强，建议拉上窗帘或调整遮阳设施":this.currentLight<400&&"night"===this.timeOfDay?"检测到光线过弱，适合开启更多灯光":null},systemStatusTip:function(){return{normal:"系统运行正常，自动监测功能已启用",saving:"当前处于节能模式，已自动调整遮阳设施",warning:"检测到光照传感器数据异常，请检查设备"}[this.systemStatus]},timeOfDay:function(){var t=(new Date).getHours();return t>6&&t<18?"day":"night"}},mounted:function(){var t=this;this.initChart(),this.getLightData(),this.dataUpdateInterval=setInterval(this.getLightData,6e4),this.chartUpdateInterval=setInterval(this.updateChartData,6e4),uni.onWindowResize((function(){var a;return null===(a=t.chart)||void 0===a?void 0:a.resize()}))},beforeDestroy:function(){var t;clearInterval(this.dataUpdateInterval),clearInterval(this.chartUpdateInterval),null===(t=this.chart)||void 0===t||t.dispose()},methods:{initChart:function(){var t=document.getElementById("lightChart");t&&(this.chart=o.init(t,"light"),this.chart.setOption(this.chartOptions))},getLightData:function(){var t=this;return(0,r.default)((0,n.default)().mark((function a(){var e;return(0,n.default)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,uni.request({url:"".concat(d.default.baseURL,"/data"),method:"GET",timeout:8e3});case 3:e=a.sent,e.data&&(t.currentLight=e.data.lightIntensity||0,t.lightData=[].concat((0,c.default)(t.lightData.slice(-59)),[t.currentLight]),t.timeData=[].concat((0,c.default)(t.timeData.slice(-59)),[new Date]),t.updateChart(),t.updateSystemStatus()),a.next=11;break;case 7:a.prev=7,a.t0=a["catch"](0),console.error("光照数据获取失败:",a.t0),t.systemStatus="warning";case 11:case"end":return a.stop()}}),a,null,[[0,7]])})))()},updateChart:function(){var t=this,a=this.timeData.map((function(a){return"hour"===t.timeFrame?"".concat(a.getHours(),":").concat(a.getMinutes().toString().padStart(2,"0")):"".concat(a.getDate(),"/").concat(a.getMonth()+1)})),e="hour"===this.timeFrame?6:5;this.chartOptions.xAxis.interval=Math.max(1,Math.floor(a.length/e)),this.chart.setOption({xAxis:{data:a},series:[{data:this.lightData}]})},toggleTimeFrame:function(t){this.timeFrame=t,this.lightData=[],this.timeData=[],this.getLightData()},updateSystemStatus:function(){this.currentLight<200&&"day"===this.timeOfDay?this.systemStatus="saving":this.lightData.length>10&&this.lightData.slice(-5).every((function(t){return t<100}))?this.systemStatus="warning":this.systemStatus="normal"},updateChartData:function(){this.lightData.length>0&&this.updateChart()}}};a.default=l},8891:function(t,a,e){"use strict";var i=e("8ecf"),s=e.n(i);s.a},"8ecf":function(t,a,e){var i=e("ff87");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var s=e("967d").default;s("3b3464dc",i,!0,{sourceMap:!1,shadowMode:!1})},c17e:function(t,a,e){"use strict";e.r(a);var i=e("fed1"),s=e("fcff");for(var n in s)["default"].indexOf(n)<0&&function(t){e.d(a,t,(function(){return s[t]}))}(n);e("8891");var c=e("828b"),r=Object(c["a"])(s["default"],i["b"],i["c"],!1,null,"c948d4c0",null,!1,i["a"],void 0);a["default"]=r.exports},db04:function(t,a,e){"use strict";var i=e("bb80"),s=e("c435"),n=e("9e70"),c=e("f298"),r=e("862c"),o=i(c),d=i("".slice),l=Math.ceil,u=function(t){return function(a,e,i){var c,u,f=n(r(a)),h=s(e),v=f.length,g=void 0===i?" ":n(i);return h<=v||""===g?f:(c=h-v,u=o(g,l(c/g.length)),u.length>c&&(u=d(u,0,c)),t?f+u:u+f)}};t.exports={start:u(!1),end:u(!0)}},fcff:function(t,a,e){"use strict";e.r(a);var i=e("7ea9"),s=e.n(i);for(var n in i)["default"].indexOf(n)<0&&function(t){e.d(a,t,(function(){return i[t]}))}(n);a["default"]=s.a},fed1:function(t,a,e){"use strict";e.d(a,"b",(function(){return i})),e.d(a,"c",(function(){return s})),e.d(a,"a",(function(){}));var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("v-uni-view",{staticClass:"flex-col page"},[e("v-uni-view",{staticClass:"flex-col header-section"},[e("v-uni-text",{staticClass:"title-text"},[e("v-uni-text",{staticClass:"icon-light"},[t._v("💡")]),t._v("智能光照监测")],1)],1),e("v-uni-view",{staticClass:"data-card"},[e("v-uni-view",{staticClass:"flex-row data-display"},[e("v-uni-view",{staticClass:"value-container"},[e("v-uni-text",{staticClass:"main-value"},[t._v(t._s(t.currentLight))]),e("v-uni-text",{staticClass:"unit"},[t._v("lux")])],1),e("v-uni-view",{staticClass:"status-indicator",class:t.statusClass})],1),e("v-uni-view",{staticClass:"status-message",class:t.statusClass},[e("v-uni-text",{staticClass:"message-text"},[t._v(t._s(t.statusMessage))]),e("v-uni-text",{staticClass:"message-icon"},[t._v(t._s(t.statusIcon))])],1),e("v-uni-view",{staticClass:"quality-scale"},[e("v-uni-view",{staticClass:"scale-item low",class:{active:"low"===t.lightStatus}}),e("v-uni-view",{staticClass:"scale-item normal",class:{active:"normal"===t.lightStatus}}),e("v-uni-view",{staticClass:"scale-item high",class:{active:"high"===t.lightStatus}})],1)],1),t.energySavingTip?e("v-uni-view",{staticClass:"info-tip"},[e("v-uni-text",{staticClass:"tip-icon"},[t._v("💡")]),e("v-uni-text",{staticClass:"tip-text"},[t._v(t._s(t.energySavingTip))])],1):t._e(),e("v-uni-view",{staticClass:"chart-section"},[e("v-uni-text",{staticClass:"section-title"},[t._v("光照变化趋势 ("+t._s("hour"===t.timeFrame?"最近1小时":"最近7天")+")")]),e("v-uni-view",{staticClass:"chart-container"},[e("v-uni-canvas",{staticClass:"chart",attrs:{id:"lightChart"}})],1),e("v-uni-view",{staticClass:"flex-row time-controls"},[e("v-uni-button",{staticClass:"time-button",class:{active:"hour"===t.timeFrame},on:{click:function(a){arguments[0]=a=t.$handleEvent(a),t.toggleTimeFrame("hour")}}},[t._v("小时数据")]),e("v-uni-button",{staticClass:"time-button",class:{active:"day"===t.timeFrame},on:{click:function(a){arguments[0]=a=t.$handleEvent(a),t.toggleTimeFrame("day")}}},[t._v("每日数据")])],1)],1),t.systemStatusTip?e("v-uni-view",{staticClass:"system-tip"},[e("v-uni-text",{staticClass:"tip-icon"},[t._v("ℹ️")]),e("v-uni-text",{staticClass:"tip-text"},[t._v(t._s(t.systemStatusTip))])],1):t._e()],1)},s=[]},ff87:function(t,a,e){var i=e("c86c");a=i(!1),a.push([t.i,".page[data-v-c948d4c0]{padding:20px;background:#f8f9fa;min-height:100vh}.header-section[data-v-c948d4c0]{margin-bottom:25px}.title-text[data-v-c948d4c0]{font-size:22px;color:#2c3e50;font-weight:600;display:flex;align-items:center}.icon-light[data-v-c948d4c0]{font-size:26px;margin-right:10px}.data-card[data-v-c948d4c0]{background:#fff;border-radius:12px;padding:25px;box-shadow:0 2px 8px rgba(0,0,0,.1);margin-bottom:20px}.data-display[data-v-c948d4c0]{justify-content:space-between;align-items:center;margin-bottom:20px}.value-container[data-v-c948d4c0]{display:flex;align-items:baseline}.main-value[data-v-c948d4c0]{font-size:48px;font-weight:700;color:#1d2129;margin-right:8px}.unit[data-v-c948d4c0]{font-size:18px;color:#86909c;position:relative;top:-2px}.status-indicator[data-v-c948d4c0]{width:20px;height:20px;border-radius:50%;box-shadow:0 2px 4px rgba(0,0,0,.1);transition:background .3s ease}.status-message[data-v-c948d4c0]{padding:12px;border-radius:8px;margin-bottom:20px;display:flex;justify-content:space-between;align-items:center;transition:all .3s ease}.quality-scale[data-v-c948d4c0]{height:6px;background:#eee;border-radius:3px;display:flex;overflow:hidden}.scale-item[data-v-c948d4c0]{flex:1;opacity:.3;transition:opacity .3s}.info-tip[data-v-c948d4c0], .system-tip[data-v-c948d4c0]{padding:15px;border-radius:8px;display:flex;align-items:center;margin-bottom:20px}.info-tip[data-v-c948d4c0]{background:#e3f2fd}.system-tip[data-v-c948d4c0]{background:#f5f5f5;border:1px solid #e0e0e0}\n/* 状态颜色定义 */.low[data-v-c948d4c0]{background:#f44336}.low.status-indicator[data-v-c948d4c0]{background:#f44336}.low.status-message[data-v-c948d4c0]{background:#ffebee}.low .message-text[data-v-c948d4c0]{color:#c62828}.normal[data-v-c948d4c0]{background:#ffc107}.normal.status-indicator[data-v-c948d4c0]{background:#ffc107}.normal.status-message[data-v-c948d4c0]{background:#fff3e0}.normal .message-text[data-v-c948d4c0]{color:#ef6c00}.high[data-v-c948d4c0]{background:#4caf50}.high.status-indicator[data-v-c948d4c0]{background:#4caf50}.high.status-message[data-v-c948d4c0]{background:#e8f5e9}.high .message-text[data-v-c948d4c0]{color:#2e7d32}.low.active[data-v-c948d4c0]{background:#f44336;opacity:1}.normal.active[data-v-c948d4c0]{background:#ffc107;opacity:1}.high.active[data-v-c948d4c0]{background:#4caf50;opacity:1}.tip-icon[data-v-c948d4c0]{font-size:20px;margin-right:10px}.tip-text[data-v-c948d4c0]{font-size:14px;color:#1976d2;line-height:1.4}.system-tip .tip-text[data-v-c948d4c0]{color:#666}.chart-section[data-v-c948d4c0]{background:#fff;border-radius:12px;padding:20px;box-shadow:0 2px 8px rgba(0,0,0,.1);margin-bottom:20px}.section-title[data-v-c948d4c0]{font-size:16px;color:#2c3e50;font-weight:500;margin-bottom:15px;display:block}.chart-container[data-v-c948d4c0]{width:100%;height:300px;background:#fff;border-radius:10px;box-shadow:0 2px 8px rgba(0,0,0,.1);padding:10px;box-sizing:border-box}.chart[data-v-c948d4c0]{width:100%;height:100%}.time-controls[data-v-c948d4c0]{margin-top:15px;justify-content:space-between}.time-button[data-v-c948d4c0]{flex:1;margin:0 5px;padding:8px 0;border-radius:6px;background:#f0f0f0;color:#666;font-size:14px;border:none}.time-button.active[data-v-c948d4c0]{background:#4a90e2;color:#fff}",""]),t.exports=a}}]);