(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-index-analyse"],{"2d66":function(t,a,e){"use strict";e.r(a);var n=e("3223"),i=e("57fc");for(var o in i)["default"].indexOf(o)<0&&function(t){e.d(a,t,(function(){return i[t]}))}(o);e("b036");var s=e("828b"),r=Object(s["a"])(i["default"],n["b"],n["c"],!1,null,"2510660d",null,!1,n["a"],void 0);a["default"]=r.exports},3223:function(t,a,e){"use strict";e.d(a,"b",(function(){return n})),e.d(a,"c",(function(){return i})),e.d(a,"a",(function(){}));var n=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("v-uni-view",{staticClass:"page"},[e("v-uni-view",{staticClass:"data-card"},[e("v-uni-view",{staticClass:"flex-row date-picker"},[e("v-uni-picker",{attrs:{mode:"date",value:t.currentDate},on:{change:function(a){arguments[0]=a=t.$handleEvent(a),t.dateChange.apply(void 0,arguments)}}},[e("v-uni-view",{staticClass:"date-input"},[t._v(t._s(t.currentDate)),e("v-uni-image",{staticClass:"calendar-icon",attrs:{src:"/static/calendar.png"}})],1)],1)],1),e("v-uni-view",{staticClass:"input-group"},[e("v-uni-view",{staticClass:"input-item"},[e("v-uni-text",{staticClass:"input-label"},[t._v("当日营收")]),e("v-uni-input",{staticClass:"input-box",attrs:{type:"number",placeholder:"¥"},model:{value:t.formData.income,callback:function(a){t.$set(t.formData,"income",a)},expression:"formData.income"}})],1),e("v-uni-view",{staticClass:"input-item"},[e("v-uni-text",{staticClass:"input-label"},[t._v("食材支出")]),e("v-uni-input",{staticClass:"input-box",attrs:{type:"number",placeholder:"¥"},model:{value:t.formData.foodCost,callback:function(a){t.$set(t.formData,"foodCost",a)},expression:"formData.foodCost"}})],1),e("v-uni-view",{staticClass:"input-item"},[e("v-uni-text",{staticClass:"input-label"},[t._v("用电支出")]),e("v-uni-input",{staticClass:"input-box",attrs:{type:"number",placeholder:"¥"},model:{value:t.formData.energyCost,callback:function(a){t.$set(t.formData,"energyCost",a)},expression:"formData.energyCost"}})],1),e("v-uni-view",{staticClass:"input-item"},[e("v-uni-text",{staticClass:"input-label"},[t._v("其他支出")]),e("v-uni-input",{staticClass:"input-box",attrs:{type:"number",placeholder:"¥"},model:{value:t.formData.otherCost,callback:function(a){t.$set(t.formData,"otherCost",a)},expression:"formData.otherCost"}})],1)],1),e("v-uni-view",{staticClass:"submit-btn",on:{click:function(a){arguments[0]=a=t.$handleEvent(a),t.saveData.apply(void 0,arguments)}}},[e("v-uni-text",{staticClass:"btn-text"},[t._v("保存数据")])],1)],1),e("v-uni-view",{staticClass:"chart-container"},[e("v-uni-view",{staticClass:"chart-card"},[e("v-uni-text",{staticClass:"chart-title"},[t._v(t._s(t.currentDate)+" 支出构成")]),t.dailyChartVisible?e("v-uni-canvas",{staticClass:"chart",attrs:{id:"dailyChart"}}):e("v-uni-view",{staticClass:"no-data"},[t._v("暂无支出数据")]),t.dailySuggestions.length>0?e("v-uni-view",{staticClass:"suggestion-box"},[e("v-uni-text",{staticClass:"suggestion-title"},[t._v("智能优化建议")]),t._l(t.dailySuggestions,(function(a,n){return e("v-uni-view",{key:n,staticClass:"suggestion-item"},[e("v-uni-image",{staticClass:"suggestion-icon",attrs:{src:"/static/bulb.png"}}),e("v-uni-text",{staticClass:"suggestion-text"},[t._v(t._s(a))])],1)}))],2):t._e()],1),e("v-uni-view",{staticClass:"chart-card"},[e("v-uni-text",{staticClass:"chart-title"},[t._v(t._s(t.currentMonth)+"月累计分析")]),t.monthChartVisible?e("v-uni-canvas",{staticClass:"chart",attrs:{id:"monthChart"}}):e("v-uni-view",{staticClass:"no-data"},[t._v("暂无月度数据")]),t.monthSuggestions.length>0?e("v-uni-view",{staticClass:"suggestion-box"},[e("v-uni-text",{staticClass:"suggestion-title"},[t._v("经营策略建议")]),t._l(t.monthSuggestions,(function(a,n){return e("v-uni-view",{key:n,staticClass:"suggestion-item"},[e("v-uni-image",{staticClass:"suggestion-icon",attrs:{src:"/static/analysis.png"}}),e("v-uni-text",{staticClass:"suggestion-text"},[t._v(t._s(a))])],1)}))],2):t._e()],1)],1)],1)},i=[]},4430:function(t,a,e){var n=e("c207");n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var i=e("967d").default;i("63b3b826",n,!0,{sourceMap:!1,shadowMode:!1})},"57fc":function(t,a,e){"use strict";e.r(a);var n=e("e28b"),i=e.n(n);for(var o in n)["default"].indexOf(o)<0&&function(t){e.d(a,t,(function(){return n[t]}))}(o);a["default"]=i.a},b036:function(t,a,e){"use strict";var n=e("4430"),i=e.n(n);i.a},c207:function(t,a,e){var n=e("c86c");a=n(!1),a.push([t.i,".page[data-v-2510660d]{padding:%?30?%;background:linear-gradient(180deg,#f8fafc,#f0f4f9)}.date-picker[data-v-2510660d]{margin-bottom:%?40?%}.input-box[data-v-2510660d]::-webkit-input-placeholder{color:#94a3b8;opacity:.6}.input-box[data-v-2510660d]::placeholder{color:#94a3b8;opacity:.6}.chart-card .legend[data-v-2510660d]{margin-top:%?20?%;text-align:center;font-size:%?24?%;color:#64748b}.data-card[data-v-2510660d]{background:hsla(0,0%,100%,.95);border-radius:%?24?%;padding:%?30?%;box-shadow:0 %?8?% %?24?% rgba(0,0,0,.06)}.date-input[data-v-2510660d]{display:flex;align-items:center;justify-content:space-between;font-size:%?32?%;color:#1e293b;padding:%?16?% %?30?%;background:#f1f5f9;border-radius:%?12?%}.calendar-icon[data-v-2510660d]{width:%?40?%;height:%?40?%}\r\n/* 修改原.no-data样式 */.no-data[data-v-2510660d]{height:%?500?%;display:flex;align-items:center;justify-content:center;color:#94a3b8;font-size:%?28?%;background:rgba(241,245,249,.5);border-radius:%?24?%}.input-group[data-v-2510660d]{margin-bottom:%?40?%}.input-item[data-v-2510660d]{margin-bottom:%?30?%}.input-label[data-v-2510660d]{display:block;font-size:%?28?%;color:#64748b;margin-bottom:%?12?%}.input-box[data-v-2510660d]{width:100%;height:%?80?%;padding:0 %?30?%;background:#f8fafc;border-radius:%?16?%;font-size:%?32?%;color:#1e293b;border:%?2?% solid #e2e8f0;transition:all .3s}.input-box[data-v-2510660d]:focus{border-color:#3b82f6;box-shadow:0 0 %?8?% rgba(59,130,246,.2)}.submit-btn[data-v-2510660d]{background:linear-gradient(135deg,#3b82f6,#6366f1);height:%?100?%;border-radius:%?16?%;display:flex;align-items:center;justify-content:center;transition:-webkit-transform .2s;transition:transform .2s;transition:transform .2s,-webkit-transform .2s}.submit-btn[data-v-2510660d]:active{-webkit-transform:scale(.98);transform:scale(.98)}.btn-text[data-v-2510660d]{color:#fff;font-size:%?32?%;font-weight:500;letter-spacing:%?1?%}.chart-container[data-v-2510660d]{margin-top:%?40?%}.chart-card[data-v-2510660d]{background:#fff;border-radius:%?24?%;padding:%?30?%;margin-bottom:%?30?%;box-shadow:0 %?8?% %?24?% rgba(0,0,0,.06)}.chart-title[data-v-2510660d]{display:block;font-size:%?32?%;color:#1e293b;font-weight:600;margin-bottom:%?30?%}.chart[data-v-2510660d]{width:100%;height:%?500?%}@media (max-width:768px){.no-data[data-v-2510660d]{height:%?400?%;font-size:%?24?%}}@media (max-width:768px){.chart[data-v-2510660d]{height:%?400?%}.date-input[data-v-2510660d]{font-size:%?28?%;padding:%?12?% %?24?%}}\r\n/*提建议*/.suggestion-box[data-v-2510660d]{margin-top:%?30?%;padding:%?25?%;background:#f8fafc;border-radius:%?16?%}.suggestion-title[data-v-2510660d]{display:block;font-size:%?28?%;color:#3b82f6;font-weight:500;margin-bottom:%?20?%}.suggestion-item[data-v-2510660d]{display:flex;align-items:center;margin:%?15?% 0;padding:%?15?%;background:rgba(59,130,246,.05);border-radius:%?12?%}.suggestion-icon[data-v-2510660d]{width:%?36?%;height:%?36?%;margin-right:%?15?%}.suggestion-text[data-v-2510660d]{font-size:%?26?%;color:#475569;line-height:1.6;flex:1}",""]),t.exports=a},e28b:function(t,a,e){"use strict";e("6a54");var n=e("3639").default,i=e("f5bd").default;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var o=i(e("2634")),s=i(e("2fdc")),r=i(e("9b1b"));e("f7a5"),e("e966"),e("bf0f"),e("e838"),e("fd3c"),e("8f71"),e("de6c"),e("9db6"),e("473f"),e("aa9c"),e("c223");var c=n(e("4500")),u={data:function(){return{currentDate:this.getTodayDate(),currentMonth:this.getCurrentMonth(),formData:this.initFormData(),dailyChartVisible:!1,monthChartVisible:!1,dailySuggestions:[],monthSuggestions:[]}},mounted:function(){this.loadData()},methods:{getTodayDate:function(){return(new Date).toISOString().slice(0,10)},getCurrentMonth:function(){return(new Date).getMonth()+1},initFormData:function(){return{income:"",foodCost:"",energyCost:"",otherCost:""}},dateChange:function(t){this.currentDate=t.detail.value,this.currentMonth=parseInt(this.currentDate.split("-")[1]),this.loadData()},loadData:function(){var t=uni.getStorageSync(this.currentDate)||this.initFormData();this.formData=(0,r.default)({},t),this.updateCharts()},validateForm:function(){var t=this;return["income","foodCost","energyCost","otherCost"].every((function(a){var e=parseFloat(t.formData[a]);return!isNaN(e)&&e>=0}))},saveData:function(){var t=this;return(0,s.default)((0,o.default)().mark((function a(){var e;return(0,o.default)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(t.validateForm()){a.next=3;break}return uni.showToast({title:"请填写有效的数字",icon:"none"}),a.abrupt("return");case 3:try{e={income:parseFloat(t.formData.income),foodCost:parseFloat(t.formData.foodCost),energyCost:parseFloat(t.formData.energyCost),otherCost:parseFloat(t.formData.otherCost)},uni.setStorageSync(t.currentDate,e),uni.showToast({title:"保存成功",icon:"success"}),t.updateCharts()}catch(n){uni.showToast({title:"保存失败",icon:"none"})}case 4:case"end":return a.stop()}}),a)})))()},getMonthData:function(){var t=this.currentDate.substr(0,7),a=uni.getStorageInfoSync().keys.filter((function(a){return a.startsWith(t)})).map((function(t){return uni.getStorageSync(t)}));return a.reduce((function(t,a){return{income:t.income+a.income,foodCost:t.foodCost+a.foodCost,energyCost:t.energyCost+a.energyCost,otherCost:t.otherCost+a.otherCost}}),{income:0,foodCost:0,energyCost:0,otherCost:0})},updateCharts:function(){var t=uni.getStorageSync(this.currentDate);if(t&&this.hasExpenseData(t)){this.dailyChartVisible=!0;var a=[{name:"食材支出",value:t.foodCost},{name:"用电支出",value:t.energyCost},{name:"其他支出",value:t.otherCost}];this.initChart("dailyChart",a,["#36A2EB","#4BC0C0","#FF9F40"],!0)}else this.dailyChartVisible=!1;var e=this.getMonthData();if(e.income>0){this.monthChartVisible=!0;var n=e.foodCost+e.energyCost+e.otherCost,i=[{name:"总营收",value:e.income},{name:"总成本",value:n},{name:"净利润",value:e.income-n}];this.initChart("monthChart",i,["#4CAF50","#FF9800","#2196F3"])}else this.monthChartVisible=!1;this.dailySuggestions=this.generateDailySuggestions(t),this.monthSuggestions=this.generateMonthSuggestions(e)},hasExpenseData:function(t){return t.foodCost>0||t.energyCost>0||t.otherCost>0},initChart:function(t,a,e){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=c.init(document.getElementById(t)),o=a.filter((function(t){return t.value>0})),s={tooltip:{formatter:n?"{b} : ¥{c} ({d}%)":"{b}: ¥{c}"},series:[{type:"pie",radius:n?["45%","70%"]:"65%",data:o,label:{fontSize:24,formatter:n?"{b|{b}}\n{d}%":"{b|{b}}\n¥{c}",rich:{b:{fontSize:24,color:"#333"}}},itemStyle:{borderRadius:8,borderColor:"#fff",borderWidth:4,color:function(t){return new c.graphic.LinearGradient(0,0,0,1,[{offset:0,color:e[t.dataIndex]+"FF"},{offset:1,color:e[t.dataIndex]+"88"}])}}}]};n||(s.legend={bottom:20,itemWidth:14,itemHeight:14,textStyle:{fontSize:24}}),i.setOption(s)},generateDailySuggestions:function(t){var a=[],e=t.foodCost+t.energyCost+t.otherCost;return t.energyCost>50&&a.push("检测到较高用电支出，建议：1.检查降温设备温度设置 2.启用自动供电模式"),t.foodCost/e>.4&&a.push("食材成本占比过高，建议：1.检查供货渠道 2.寻找新进货途径"),t.energyCost>30&&t.energyCost/e>.3&&a.push("检测到节能优化空间，建议接入智能电表进行设备级能耗监控"),t.income>1e3&&a.push("检测到高营收日模式，建议：1.增加备货量 2.增加员工排班进行调休"),t.income<300&&a.push("检测到低营收日模式，建议：1.进行广告宣发 2.举办优惠活动"),a.slice(0,3)},generateMonthSuggestions:function(t){var a=[],e=t.foodCost+t.energyCost+t.otherCost,n=t.income-e;if(t.income>0&&t.energyCost>0){var i=t.energyCost/t.income*100,o=i.toFixed(1)+"%";i>8?(a.push("⚠️ 电费占比过高（".concat(o,"），超出行业警戒线（").concat(8,"%）：")),a.push("1. 优先检查制冷/制热设备效率"),a.push("2. 优化设备运行时间段（错峰用电）"),a.push("3. 考虑升级能效等级更高的设备")):i>6?(a.push("⚡ 电费占比（".concat(o,"）略高于行业平均（").concat(6,"%）：")),a.push("1. 检查照明设备使用情况（改用LED）"),a.push("2. 调整冷藏设备温度设置")):i<4?a.push("✅ 电费控制优秀（".concat(o,"），低于优秀标准（").concat(4,"%）")):a.push("📊 当前电费占比 ".concat(o,"，处于行业合理水平（").concat(6,"%）"));var s=t.income/t.energyCost;a.push("每元电费创造营收：¥".concat(s.toFixed(1)))}return n/t.income<.2&&a.push("当前利润率".concat((n/t.income*100).toFixed(1),"%，建议优化成本结构")),a.slice(0,5)},getAverage:function(t){var a=uni.getStorageInfoSync().keys.map((function(a){return uni.getStorageSync(a)[t]||0}));return a.reduce((function(t,a){return t+a}),0)/(a.length||1)}}};a.default=u}}]);