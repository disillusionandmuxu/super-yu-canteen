(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-index-smoke"],{"0323":function(t,a,e){"use strict";var i=e("ebde"),n=e.n(i);n.a},1127:function(t,a,e){"use strict";e.r(a);var i=e("b761"),n=e.n(i);for(var r in i)["default"].indexOf(r)<0&&function(t){e.d(a,t,(function(){return i[t]}))}(r);a["default"]=n.a},"5dc0":function(t,a,e){var i=e("c86c");a=i(!1),a.push([t.i,".page[data-v-21ed5a87]{padding:20px;background-color:#f5f5f5;min-height:100vh}.header[data-v-21ed5a87]{padding:15px 0;border-bottom:1px solid #e0e0e0;margin-bottom:20px}.title[data-v-21ed5a87]{font-size:24px;color:#2c3e50;font-weight:700;text-align:center}.data-card[data-v-21ed5a87]{background:#fff;border-radius:10px;padding:20px;margin-bottom:20px;box-shadow:0 2px 8px rgba(0,0,0,.1);text-align:center}.data-label[data-v-21ed5a87]{font-size:16px;color:#7f8c8d;display:block;margin-bottom:5px}.data-value[data-v-21ed5a87]{font-size:36px;font-weight:700;color:#2c3e50;display:block;margin:10px 0}.status-indicator[data-v-21ed5a87]{padding:8px 15px;border-radius:20px;display:inline-block;font-size:14px;&.normal{background-color:rgba(46,204,113,.2);color:#27ae60}&.warning{background-color:rgba(241,196,15,.2);color:#f39c12;-webkit-animation:pulse-data-v-21ed5a87 1s infinite;animation:pulse-data-v-21ed5a87 1s infinite}&.emergency{background-color:rgba(231,76,60,.2);color:#e74c3c;-webkit-animation:blink-data-v-21ed5a87 .5s infinite;animation:blink-data-v-21ed5a87 .5s infinite}}@-webkit-keyframes pulse-data-v-21ed5a87{0%{opacity:1}50%{opacity:.7}100%{opacity:1}}@keyframes pulse-data-v-21ed5a87{0%{opacity:1}50%{opacity:.7}100%{opacity:1}}@-webkit-keyframes blink-data-v-21ed5a87{0%, 100%{opacity:1}50%{opacity:.5}}@keyframes blink-data-v-21ed5a87{0%, 100%{opacity:1}50%{opacity:.5}}.chart-section[data-v-21ed5a87]{background:#fff;border-radius:12px;padding:20px;box-shadow:0 2px 8px rgba(0,0,0,.1);margin-bottom:20px}.section-title[data-v-21ed5a87]{font-size:16px;color:#2c3e50;font-weight:500;margin-bottom:15px;display:block}.chart-container[data-v-21ed5a87]{width:100%;height:300px;background:#fff;border-radius:10px;box-shadow:0 2px 8px rgba(0,0,0,.1);padding:10px;box-sizing:border-box}.chart[data-v-21ed5a87]{width:100%;height:100%}",""]),t.exports=a},"73e1":function(t,a,e){"use strict";var i=e("29d8");t.exports=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(i)},"795c":function(t,a,e){"use strict";var i=e("8bdb"),n=e("db04").start,r=e("73e1");i({target:"String",proto:!0,forced:r},{padStart:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}})},9973:function(t,a,e){"use strict";e.r(a);var i=e("b8b4"),n=e("1127");for(var r in n)["default"].indexOf(r)<0&&function(t){e.d(a,t,(function(){return n[t]}))}(r);e("0323");var o=e("828b"),s=Object(o["a"])(n["default"],i["b"],i["c"],!1,null,"21ed5a87",null,!1,i["a"],void 0);a["default"]=s.exports},b761:function(t,a,e){"use strict";e("6a54");var i=e("3639").default,n=e("f5bd").default;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,e("c223"),e("795c"),e("c9b5"),e("bf0f"),e("ab80"),e("aa9c"),e("fd3c");var r=n(e("2634")),o=n(e("2fdc")),s=i(e("b4e9")),d=n(e("e4d6")),c={data:function(){return{smokeLevel:0,historyData:[],chart:null,dataUpdateInterval:null}},computed:{statusClass:function(){return this.smokeLevel>800?"emergency":this.smokeLevel>400?"warning":"normal"},statusText:function(){return this.smokeLevel>800?"🔥 火灾警报！请立即处理！":this.smokeLevel>400?"⚠️ 烟雾超标！建议通风":"✅ 空气质量正常"}},mounted:function(){this.initChart(),this.getSmokeData(),this.dataUpdateInterval=setInterval(this.getSmokeData,6e4)},beforeDestroy:function(){clearInterval(this.dataUpdateInterval),this.chart.dispose()},methods:{initChart:function(){var t=document.getElementById("smokeChart");this.chart=s.init(t);var a={backgroundColor:"#f9f9f9",title:{text:"烟雾浓度变化趋势",left:"center",textStyle:{color:"#333",fontSize:16}},tooltip:{trigger:"axis",formatter:"{b}<br/>浓度: {c} ppm"},xAxis:{type:"category",data:[],axisLine:{lineStyle:{color:"#999"}}},yAxis:{type:"value",name:"浓度 (ppm)",axisLine:{show:!0,lineStyle:{color:"#999"}},splitLine:{lineStyle:{color:"#eee"}}},series:[{name:"烟雾浓度",type:"line",data:[],smooth:!0,lineStyle:{width:3,color:"#3498db"},itemStyle:{color:"#2980b9"},areaStyle:{color:new s.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"rgba(52, 152, 219, 0.5)"},{offset:1,color:"rgba(52, 152, 219, 0.1)"}])}}]};this.chart.setOption(a)},getSmokeData:function(){var t=this;return(0,o.default)((0,r.default)().mark((function a(){var e;return(0,r.default)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,uni.request({url:"".concat(d.default.baseURL,"/data"),timeout:5e3});case 3:e=a.sent,e.data&&t.updateData(e.data.smokeLevel||0),a.next=10;break;case 7:a.prev=7,a.t0=a["catch"](0),console.error("数据获取失败:",a.t0);case 10:case"end":return a.stop()}}),a,null,[[0,7]])})))()},updateData:function(t){this.smokeLevel=t;var a=new Date,e="".concat(a.getHours(),":").concat(a.getMinutes().toString().padStart(2,"0"));this.historyData.push({time:e,value:t}),this.historyData.length>20&&this.historyData.shift(),this.updateChart(),t>400&&this.triggerAlarm(t)},updateChart:function(){var t=this.historyData.map((function(t){return t.time})),a=this.historyData.map((function(t){return t.value}));this.chart.setOption({xAxis:{data:t},series:[{data:a}]})},triggerAlarm:function(t){t>800&&(this.$refs.alarmAudio.play(),uni.showModal({title:"火灾警报",content:"检测到危险烟雾浓度！请立即处理！",showCancel:!1}),uni.request({url:"".concat(d.default.baseURL,"/control"),method:"POST",data:{device:"fan",state:"on"}}))}}};a.default=c},b8b4:function(t,a,e){"use strict";e.d(a,"b",(function(){return i})),e.d(a,"c",(function(){return n})),e.d(a,"a",(function(){}));var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("v-uni-view",{staticClass:"page"},[e("v-uni-view",{staticClass:"header"},[e("v-uni-text",{staticClass:"title"},[t._v("智能烟雾监测系统")])],1),e("v-uni-view",{staticClass:"data-card"},[e("v-uni-text",{staticClass:"data-label"},[t._v("当前烟雾浓度")]),e("v-uni-text",{staticClass:"data-value"},[t._v(t._s(t.smokeLevel)+" ppm")]),e("v-uni-view",{staticClass:"status-indicator",class:t.statusClass},[e("v-uni-text",[t._v(t._s(t.statusText))])],1)],1),e("v-uni-view",{staticClass:"chart-container"},[e("v-uni-canvas",{staticClass:"chart",attrs:{id:"smokeChart"}})],1),e("v-uni-audio",{ref:"alarmAudio",attrs:{src:"/static/alarm.mp3"}})],1)},n=[]},db04:function(t,a,e){"use strict";var i=e("bb80"),n=e("c435"),r=e("9e70"),o=e("f298"),s=e("862c"),d=i(o),c=i("".slice),l=Math.ceil,u=function(t){return function(a,e,i){var o,u,f=r(s(a)),p=n(e),v=f.length,h=void 0===i?" ":r(i);return p<=v||""===h?f:(o=p-v,u=d(h,l(o/h.length)),u.length>o&&(u=c(u,0,o)),t?f+u:u+f)}};t.exports={start:u(!1),end:u(!0)}},e4d6:function(t,a,e){"use strict";e("6a54"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i={baseURL:uni.getStorageSync("esp32_ip")||"http://192.168.4.1:5000"};a.default=i},ebde:function(t,a,e){var i=e("5dc0");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var n=e("967d").default;n("212fbcdd",i,!0,{sourceMap:!1,shadowMode:!1})}}]);